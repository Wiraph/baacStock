<div class="m-2 bg-white shadow-md rounded-md"
  *ngIf="!showDetailComponent && !showDetailComponentCreate && activeView=='table'">
  <div class="py-2 bg-green-400 flex justify-center rounded-t-md">
    <p class="text-white font-semibold">{{ brName }} : ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
  </div>
  <div *ngIf="requestList.length === 0" class="py-7 text-center">
    <span class="text-2xl text-orange-600">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
  </div>
  <div *ngIf="requestList.length > 0" class="p-4">
    <div class="overflow-x-auto">
      <table class="w-full table-auto border-collapse shadow-lg rounded-lg overflow-hidden text-sm">
        <thead class="bg-gradient-to-r from-green-200 to-green-100 text-gray-800">
          <tr>
            <th class="p-3 text-center border-b font-semibold">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
            <th class="p-3 text-center border-b font-semibold">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô</th>
            <th class="p-3 text-center border-b font-semibold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
            <th class="p-3 text-center border-b font-semibold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
            <th class="p-3 text-center border-b font-semibold">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</th>
            <th class="p-3 text-center border-b font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô</th>
            <th class="p-3 text-center border-b font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
            <th class="p-3 text-center border-b font-semibold">‡πÅ‡∏™‡∏î‡∏á</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let item of requestList; let i = index" class="hover:bg-green-50 transition duration-150">
            <td class="p-3 text-center">{{ i + 1 }}</td>
            <td class="p-3 text-center">{{ item.cusiD }}</td>
            <td class="p-3 text-center">{{ item.titleABBR }}{{ item.cusFName }} {{ item.cusLName }}</td>
            <td class="p-3 text-center">{{ item.STKbrName }}</td>
            <td class="p-3 text-center">{{ item.stkNOTE }}</td>
            <td class="p-3 text-center">{{ item.stkUNiT | number:'1.0-0' }}</td>
            <td class="p-3 text-center">{{ item.stkVALUE | number:'1.0-0' }}</td>
            <td class="p-3 text-center">
              <button type="button" class="cursor-pointer hover:text-green-600 focus:outline-none"
                (click)="approveConfirm(item.stkNOTE, item.stCODEs)">
                üìù
              </button>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="flex justify-between items-center mt-4 px-4">
        <button (click)="prevPage()" [disabled]="pageNumber <= 1"
          class="bg-gray-300 px-3 py-1 rounded">‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô</button>
        <span>‡∏´‡∏ô‡πâ‡∏≤ {{pageNumber}}</span>
        <button (click)="nextPage()" class="bg-gray-300 px-3 py-1 rounded">‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="activeView == 'detail'" class="fixed inset-0 z-50 flex flex-col bg-white shadow-lg overflow-y-auto">
  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î -->
  <div class="ml-auto p-4">
    <button (click)="closeWindows()" class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition">
      ‚ùå ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
    </button>
  </div>
  <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ -->
  <div class="flex items-center flex-col space-y-4 px-4 pb-6">
    <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
    <div class="w-full md:w-9/12 bg-orange-400 py-3 rounded-md shadow text-center text-white text-lg font-semibold">
      ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£{{detailData?.status}}
    </div>
    <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
    <div class="w-full md:w-9/12 bg-gray-50 p-4 rounded-md shadow space-y-2">
      <div class="flex gap-2">
        <p>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ :</p>
        <p>{{ formatDate(detailData?.datetimeup || "") }}</p>
      </div>
      <div class="flex gap-2">
        <p>üë§ ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ :</p>
        <p>{{detailData?.userName}} ( {{detailData?.lvlCode}} : {{detailData?.lvlDesc}} )</p>
      </div>
      <div class="flex gap-2">
        <p>üè¢ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ :</p>
        <p>{{detailData?.brCode}} : {{detailData?.brName}}</p>
      </div>
    </div>
    <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô / ‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô -->
    <div class="w-full md:w-9/12 bg-orange-400 py-3 rounded-md shadow text-center text-white text-lg font-semibold">
      ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô / ‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô
    </div>
    <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô -->
    <div class="w-full md:w-9/12 bg-gray-50 p-4 rounded-md shadow space-y-4">
      <div class="grid grid-cols-2 gap-2">
        <p>ü™™ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô: {{detailData?.cusId}}</p>
        <p>üóì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏• : {{formatDate(detailData?.dateIssue || "")}}</p>
      </div>
      <div class="grid grid-cols-2 gap-2">
        <p>üôç‚Äç‚ôÇÔ∏è ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• : {{detailData?.fullname}} [ {{detailData?.custype}} ]</p>
      </div>
      <hr class="my-2 border-gray-300" />
      <div class="grid grid-cols-2 gap-2">
        <p>üîñ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô : {{detailData?.stkNote}}</p>
        <p>üÜî ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏∏‡πâ‡∏ô : {{detailData?.stkNostart}} - {{detailData?.stkNoend }}</p>
      </div>
      <div class="grid grid-cols-2 gap-2">
        <p>üî¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô : {{detailData?.unit}}</p>
        <p>üí∞ ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏´‡∏∏‡πâ‡∏ô : {{detailData?.unitValue | number:'1.0-0'}}</p>
      </div>
      <div class="grid grid-cols-2 gap-2" *ngIf="detailData?.acctype != '001'">
        <p>üè¶ ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡πÇ‡∏î‡∏¢ : {{detailData?.paydesc}}</p>
      </div>
      <div *ngIf="detailData?.acctype == '001'">
        <div class="flex gap-2">
          <p>üè¶ ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡πÇ‡∏î‡∏¢ : {{detailData?.paydesc}}{{detailData?.acctypedesc}} ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ :
            {{detailData?.accno}} ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ : {{detailData?.accname}}</p>
        </div>
      </div>
      <hr class="my-2 border-gray-300" />
      <div class="grid grid-row-2 gap-2">
        <p>üìÑ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô : {{detailData?.statusDesc}}</p>
        <p>üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ : {{detailData?.note || "-"}}</p>
      </div>
      <hr class="my-2 border-gray-300" />
      <!-- ‡∏õ‡∏∏‡πà‡∏° -->
      <div class="flex justify-center gap-4 pt-4">
        <button (click)="approveSelectedIssue()"
          class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-md transition">
          ‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
        </button>
        <button (click)="notapproveSelectedIssue()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md transition">
          ‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
        </button>
      </div>
    </div>
  </div>
</div>
<!-- ‚úÖ Loading Overlay ‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ + ‡∏°‡∏≠‡∏á‡∏ó‡∏∞‡∏•‡∏∏ + ‡πÄ‡∏ö‡∏•‡∏≠ -->
<div *ngIf="loading"
  class="fixed inset-0 z-50 flex items-center justify-center bg-gray-100 bg-opacity-40 backdrop-blur-sm"
  style="background-color: rgba(128, 128, 128, 0.7);">
  <div class="text-center">
    <svg class="animate-spin h-10 w-10 text-blue-600 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none"
      viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" />
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" />
    </svg>
    <p class="text-lg text-white font-medium">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
  </div>
</div>