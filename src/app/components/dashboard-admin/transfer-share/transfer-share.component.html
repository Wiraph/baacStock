<div *ngIf="activeView == 'search'">
  <app-search-edit (statusView)="onTransferStockSelected($event)"></app-search-edit>
</div>

<div *ngIf="activeView === 'transfer'">
    <div class="m-4 rounded-md shadow-md bg-white">
        <p class="text-center py-3 rounded-t-md bg-green-400 text-xl font-semibold text-white">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô :
            ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ó‡∏ô‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∏‡∏î/‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢</p>
        <div class="text-center py-4 gap-4">
            <div class="flex justify-center gap-4">
                <p>‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà :  {{ customerData.cusiD }}</p>
                <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ : {{ customerData.staDesc }} </p>
            </div>
            <p>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• : {{ customerData.title }}{{ customerData.fname }} {{ customerData.lname }}</p>
        </div>
        <div class="p-4">
            <table class="table-auto w-full border border-gray-300 rounded-lg shadow-sm">
                <thead>
                    <tr class="bg-blue-600 text-white text-sm uppercase tracking-wider">
                        <th class="px-4 py-2 text-center">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                        <th class="px-4 py-2 text-left">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                        <th class="px-4 py-2 text-left">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</th>
                        <th class="px-4 py-2 text-left">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡πÄ‡∏î‡∏¥‡∏°</th>
                        <th class="px-4 py-2 text-left">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏∏‡πâ‡∏ô</th>
                        <th class="px-4 py-2 text-right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô</th>
                        <th class="px-4 py-2 text-right">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏´‡∏∏‡πâ‡∏ô</th>
                        <th class="px-4 py-2 text-center">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th class="px-4 py-2 text-center">‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                        <th class="px-4 py-2 text-center">‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200" *ngFor="let item of stkTransList; ">
                    <tr class="hover:bg-gray-50 transition">
                        <td class="px-4 py-2 text-center">{{ item.roWi }}</td>
                        <td class="px-4 py-2">{{ item.brCode }}</td>
                        <td class="px-4 py-2">{{ item.stkNOTE }}</td>
                        <td class="px-4 py-2">{{ item.stkNOTEo }}</td>
                        <td class="px-4 py-2">{{ item.stkNOStart }} - {{ item.stkNOStop }}</td>
                        <td class="px-4 py-2 text-right">{{ item.stkUNiT | number:'1.0-0' }}</td>
                        <td class="px-4 py-2 text-right">{{ item.stkVALUE | number:'1.0-0'}}</td>
                        <td class="px-4 py-2 text-center">{{ item.stDESC }}</td>
                        <td class="px-4 py-2 text-center">{{ formatThaiDateTime(item.datetimeup) || '-' }}</td>
                        <td class="px-4 py-2 text-center">
                            <button class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600" 
                                    (click)="onTransferClick(item)">
                                ‡πÇ‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏°‡∏∑‡∏≠
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>


<div *ngIf="activeView == 'transfers'" class="max-w-7xl mx-auto p-4 bg-white shadow-lg rounded-lg">
    <div class="bg-green-500 text-white text-center py-3 rounded-t-lg mb-4">
        <h2 class="text-xl font-semibold">‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏≠‡∏ô‡∏´‡∏∏‡πâ‡∏ô</h2>
    </div>
    <div class="bg-gray-50 p-3 mb-4" *ngIf="selectedcustomer && selectStockTransfer">
        <div class="grid grid-cols-3 gap-2">
        <div>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô : {{ selectedcustomer.cusId || '-' }}</div>
        <div>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô : {{ selectStockTransfer.stkNote || '-' }}</div>
        <div>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏∏‡πâ‡∏ô : {{ selectStockTransfer.stkStart || '-' }} - {{ selectStockTransfer.stkEnd || '-' }}</div>
    </div>
    <div class="grid grid-cols-3 gap-2 mt-1">
        <div>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• : {{ selectedcustomer.fullName || '-' }}</div>
        <div>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ : {{ selectedStock.staDesc || '-' }}</div>
        <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô : {{ selectStockTransfer.unit || 0 }} ‡∏´‡∏∏‡πâ‡∏ô</div>
    </div>
         <div class="flex items-center justify-center my-6 space-x-4 text-base font-medium">
         <div class="flex items-center space-x-2">
             <span class="bg-blue-100 text-black px-3 py-1 rounded">‡∏ú‡∏π‡πâ‡πÇ‡∏≠‡∏ô</span>
             <span class="text-gray-400 text-2xl">‚¨ÜÔ∏è-‚¨áÔ∏è</span>
             <span class="bg-blue-100 text-black px-3 py-1 rounded">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏≠‡∏ô</span>
         </div>
     </div>
    <form class="space-y-3">
        <div class="flex items-center space-x-2">
            <label class="font-medium text-gray-700 w-32">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡∏´‡∏∏‡πâ‡∏ô :</label>
            <select [(ngModel)]="transferForm.reason" 
                name="reason"
                class="flex-1 border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-blue-500">
            <option value="">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡∏´‡∏∏‡πâ‡∏ô</option>
            <option *ngFor="let rem of remcodeList" [value]="rem.remCode">
                {{ rem.remDesc }}
            </option>
        </select>
        </div>
        <div class="flex items-center space-x-2">
            <label class="font-medium text-gray-700 w-32">‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô :</label>
            <input type="text" 
                [(ngModel)]="transferForm.idCard" 
                name="idCard"
                class="flex-1 border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-blue-500">
            <button type="button" 
                (click)="onSaveTransfer()"
                class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded flex items-center">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            </button> 
        </div>
    </form>
</div>

<div *ngIf="loading"
    class="fixed inset-0 z-50 flex items-center justify-center bg-gray-100 bg-opacity-40 backdrop-blur-sm"
    style="background-color: rgba(128, 128, 128, 0.7);">
    <div class="text-center">
        <svg class="animate-spin h-10 w-10 text-blue-600 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none"
        viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" />
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" />
        </svg>
        <p class="text-lg text-white font-medium">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
    </div>
</div>