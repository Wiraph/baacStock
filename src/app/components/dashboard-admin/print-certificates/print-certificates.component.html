<!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô -->
<div class="bg-white shadow-md">
  <!-- Header ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß -->
  <div class="w-full bg-green-500 h-auto text-white text-center text-xl font-bold py-2 rounded-t-lg">
    ‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô
  </div>
      
  <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
  <div class="p-8">
    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-800 mb-6 text-center">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</h3>
      
      <!-- ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
      <div class="space-y-4 mb-6">
        <!-- ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô -->
        <div class="flex items-center space-x-3">
          <input type="radio" id="search-type-stknote" name="searchTypeRadio" value="stkNOTE" 
                 [(ngModel)]="searchTypeRadio"
                 (change)="onSearchTypeChange('stkNOTE')"
                 class="w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500">
          <label for="search-type-stknote" class="text-sm font-medium text-gray-700">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</label>
          <input type="text" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô" 
                 [(ngModel)]="stkNOTE"
                 [disabled]="isStkNOTEDisabled()"
                 [class]="isStkNOTEDisabled() ? 'flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm bg-gray-100 text-gray-500' : 'flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent'">
        </div>

        <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
        <div class="flex items-center space-x-3">
          <input type="radio" id="search-type-date" name="searchTypeRadio" value="date" 
                 [(ngModel)]="searchTypeRadio"
                 (change)="onSearchTypeChange('date')"
                 class="w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500">
          
          <!-- Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
          <select [(ngModel)]="dateType" (change)="onDateTypeChange(dateType)"
                  [disabled]="isDateDisabled()"
                  [class]="isDateDisabled() ? 'border border-gray-300 rounded-md px-3 py-2 text-sm bg-gray-100 text-gray-500' : 'border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent'">
            <option value="stkDateIssue">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</option>
            <option value="stkDateEffect">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•</option>
            <option value="stkDateApprove">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏Ç‡∏≤‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</option>
          </select>
          
          <select [(ngModel)]="timeType" (change)="onTimeTypeChange(timeType)" 
                  [disabled]="isTimeTypeDisabled()"
                  [class]="isTimeTypeDisabled() ? 'border border-gray-300 rounded-md px-3 py-2 text-sm bg-gray-100 text-gray-500' : 'border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent'">
            <option value="date-year">‡∏õ‡∏µ</option>
            <option value="date-range">‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</option>
            <option value="date-day">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</option>
          </select>
        </div>

        <!-- ‡∏õ‡∏µ -->
        <div class="ml-7" *ngIf="searchTypeRadio === 'date' && timeType === 'date-year'">
          <select [(ngModel)]="dateYear" class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ</option>
            <option *ngFor="let year of yearOptions" [value]="year.value">{{ year.label }}</option>
          </select>
        </div>
          
        <!-- ‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
        <div *ngIf="searchTypeRadio === 'date' && timeType === 'date-range'" class="ml-7">
          <div class="flex items-center space-x-3 mb-2">
            <label for="" class="text-sm font-medium text-gray-700 min-w-[85px]">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
            <div class="flex space-x-2 flex-1">
              <select [(ngModel)]="dateRangeStartD" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                <option value="" disabled selected>‡∏ß‡∏±‡∏ô</option>
                <option *ngFor="let day of dayOptions" [value]="day.value">{{ day.label }}</option>
              </select>
              <select [(ngModel)]="dateRangeStartM" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                <option value="" disabled selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                <option *ngFor="let month of monthOptions" [value]="month.value">{{ month.label }}</option>
              </select>
              <select [(ngModel)]="dateRangeStartY" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                <option value="" disabled selected>‡∏õ‡∏µ</option>
                <option *ngFor="let year of yearOptions" [value]="year.value">{{ year.label }}</option>
              </select>
            </div>
          </div>
          <div class="flex items-center space-x-3">
            <label for="" class="text-sm font-medium text-gray-700 min-w-[85px]">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
            <div class="flex space-x-2 flex-1">
              <select [(ngModel)]="dateRangeStopD" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                <option value="" disabled selected>‡∏ß‡∏±‡∏ô</option>
                <option *ngFor="let day of dayOptions" [value]="day.value">{{ day.label }}</option>
              </select>
              <select [(ngModel)]="dateRangeStopM" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                <option value="" disabled selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                <option *ngFor="let month of monthOptions" [value]="month.value">{{ month.label }}</option>
              </select>
              <select [(ngModel)]="dateRangeStopY" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                <option value="" disabled selected>‡∏õ‡∏µ</option>
                <option *ngFor="let year of yearOptions" [value]="year.value">{{ year.label }}</option>
              </select>
            </div>
          </div>
        </div>

        <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß -->
        <div class="flex space-x-2 flex-1 ml-7" *ngIf="searchTypeRadio === 'date' && timeType === 'date-day'">
          <select [(ngModel)]="dateDayD" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="" disabled selected>‡∏ß‡∏±‡∏ô</option>
            <option *ngFor="let day of dayOptions" [value]="day.value">{{ day.label }}</option>
          </select>
          <select [(ngModel)]="dateDayM" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="" disabled selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
            <option *ngFor="let month of monthOptions" [value]="month.value">{{ month.label }}</option>
          </select>
          <select [(ngModel)]="dateDayY" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="" disabled selected>‡∏õ‡∏µ</option>
            <option *ngFor="let year of yearOptions" [value]="year.value">{{ year.label }}</option>
          </select>
        </div>
      </div>

      <!-- ‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ô‡∏≤‡∏° -->
      <div class="space-y-4 mb-6">

        <!-- Error loading signatures -->
        <div *ngIf="signatureError" class="bg-red-100 border border-red-400 text-red-700 px-3 py-2 rounded text-sm">
          {{ signatureError }}
          <button (click)="loadSignatureList()" class="ml-2 text-blue-600 hover:text-blue-800 underline">
            ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
          </button>
        </div>

        <!-- Signature count -->
        <div *ngIf="!loadingSignatures && !signatureError && signatureList.length > 0" class="text-sm text-gray-600">
          ‡∏û‡∏ö‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ô‡∏≤‡∏° {{ signatureList.length }} ‡∏Ñ‡∏ô
        </div>

        <div class="flex items-center space-x-3">
          <label for="" class="text-sm font-medium text-gray-700 min-w-[80px]">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ô‡∏≤‡∏° 1</label>
          <select [(ngModel)]="sigNature1" class="flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ô‡∏≤‡∏°</option>
            <option *ngFor="let sig of signatureList" [value]="sig.empId">{{ sig.empName }}</option>
          </select>
        </div>
        
        <div class="flex items-center space-x-3">
          <label for="" class="text-sm font-medium text-gray-700 min-w-[80px]">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ô‡∏≤‡∏° 2</label>
          <select [(ngModel)]="sigNature2" class="flex-1 border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ô‡∏≤‡∏°</option>
            <option *ngFor="let sig of signatureList" [value]="sig.empId">{{ sig.empName }}</option>
          </select>
        </div>
      </div>
      
      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
      <div class="text-center">
        <button (click)="onSearch()" 
                [disabled]="loadingStocks"
                class="bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold py-2.5 px-5 rounded-lg transition-colors duration-200 transform flex items-center justify-center gap-3 shadow-md mx-auto">
          <div *ngIf="loadingStocks" class="inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
          üîç {{ loadingStocks ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...' : '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤' }}
        </button>
      </div>
    </div>

    <!-- ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <div *ngIf="stockList.length > 0 || loadingStocks || stockError" class="mt-8 max-w-6xl mx-auto">
      <h3 class="text-lg font-semibold text-gray-800 mb-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
      
      <!-- Loading -->
      <div *ngIf="loadingStocks" class="text-center py-8">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"></div>
        <p class="mt-2 text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
      </div>

      <!-- Error -->
      <div *ngIf="stockError" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
        {{ stockError }}
      </div>

      <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
      <div *ngIf="stockList.length > 0" class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm">
        <table class="min-w-full text-sm text-left text-gray-800">
          <thead class="bg-green-50 text-gray-700 text-xs uppercase tracking-wide">
            <tr>
              <th class="px-4 py-3 text-center">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
              <th class="px-4 py-3">‡∏™‡∏≤‡∏Ç‡∏≤</th>
              <th class="px-4 py-3">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</th>
              <th class="px-4 py-3">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</th>
              <th class="px-4 py-3">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô</th>
              <th class="px-4 py-3 text-center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô</th>
              <th class="px-4 py-3 text-center">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤</th>
              <th class="px-4 py-3 text-center">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
              <th class="px-4 py-3 text-center">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let stock of stockList; let i = index" class="hover:bg-gray-50 transition">
              <td class="px-4 py-2 text-center">{{ i + 1 }}</td>
              <td class="px-4 py-2">{{ stock.brName || stock.brCode }}</td>
              <td class="px-4 py-2">{{ stock.stkNOTE }}</td>
              <td class="px-4 py-2">{{ stock.cusiD }}</td>
              <td class="px-4 py-2">{{ stock.fullName }}</td>
              <td class="px-4 py-2 text-center">{{ stock.stkUNiT | number }}</td>
              <td class="px-4 py-2 text-center">{{ stock.stkValue | number: '1.0-0' }}</td>
              <td class="px-4 py-2 text-center">
                <span class="px-2 py-1 text-xs rounded-full" 
                      [class]="stock.stkSTATUS === 'S000' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'">
                  {{ stock.statusDesc || stock.stkSTATUS }}
                </span>
              </td>
              <td class="px-4 py-2 text-center">{{ stock.stkDateIssue | date: 'dd/MM/yyyy' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
      <div *ngIf="!loadingStocks && !stockError && stockList.length === 0" class="text-center py-8 text-gray-500">
        <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
      </div>
    </div>
  </div>
</div>

