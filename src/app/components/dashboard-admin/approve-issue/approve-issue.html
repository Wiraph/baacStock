<div *ngIf="activeView == 'table'" class="m-2 bg-white rounded-md">
    <div class="py-2 bg-green-500 rounded-t-md">
        <p class="text-center text-white">{{ brName }} : ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</p>
    </div>

    <div *ngIf="issueList.length === 0" class="py-7 text-center">
        <span class="text-2xl text-orange-600">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</span>
    </div>
    <div *ngIf="issueList.length > 0" class="overflow-x-auto mt-4 p-4">
        <table class="min-w-full bg-white shadow-md rounded-lg overflow-hidden">
            <thead class="bg-green-400 text-white">
                <tr>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                    <th class="py-3 px-4 text-center text-sm font-semibold">‡πÅ‡∏™‡∏î‡∏á</th>
                </tr>
            </thead>
            <tbody class="text-gray-700">
                <tr *ngFor="let item of issueList; let i = index" class="even:bg-gray-100 hover:bg-gray-200">
                    <td class="py-2 px-4 text-center">{{ i+1 }}</td>
                    <td class="py-2 px-4 text-center">{{item.cusiD}}</td>
                    <td class="py-2 px-4 text-center">{{item.titleABBR}}{{item.cusFName}} {{item.cusLName}}</td>
                    <td class="py-2 px-4 text-center">{{item.STKbrName}}</td>
                    <td class="py-2 px-4 text-center">{{item.stkNOTE}}</td>
                    <td class="py-2 px-4 text-center">{{item.stkUNiT}}</td>
                    <td class="py-2 px-4 text-center">{{item.stkVALUE | number:'1.0-0'}}</td>
                    <td class="py-2 px-4 text-center">
                        <button class="cursor-pointer" (click)="detailIssue(item.stkNOTE)">üìù</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="flex justify-between items-center mt-4 px-4">
            <button (click)="prevPage()" [disabled]="pageNumber <= 1"
                class="bg-gray-300 px-3 py-1 rounded">‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô</button>
            <span>‡∏´‡∏ô‡πâ‡∏≤ {{pageNumber}}</span>
            <button (click)="nextPage()" class="bg-gray-300 px-3 py-1 rounded">‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
    </div>
</div>

<div *ngIf="activeView == 'detail'" class="fixed inset-0 z-50 flex flex-col bg-white shadow-lg overflow-y-auto">
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î -->
    <div class="ml-auto p-4">
        <button (click)="closeWindows()" class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition">
            ‚ùå ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
        </button>
    </div>
    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ -->
    <div class="flex items-center flex-col space-y-4 px-4 pb-6">
        <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
        <div class="w-full md:w-9/12 bg-orange-400 py-3 rounded-md shadow text-center text-white text-lg font-semibold">
            ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£{{issuadata.status}}
        </div>
        <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
        <div class="w-full md:w-9/12 bg-gray-50 p-4 rounded-md shadow space-y-2">
            <div class="flex gap-2">
                <p>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ :</p>
                <p>{{ formatDate(issuadata.datetimeup) }}</p>
            </div>
            <div class="flex gap-2">
                <p>üë§ ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ :</p>
                <p>{{issuadata.userName}} ( {{issuadata.lvlCode}} : {{issuadata.lvlDesc}} )</p>
            </div>
            <div class="flex gap-2">
                <p>üè¢ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ :</p>
                <p>{{issuadata.brCode}} : {{issuadata.brName}}</p>
            </div>
        </div>
        <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô / ‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô -->
        <div class="w-full md:w-9/12 bg-orange-400 py-3 rounded-md shadow text-center text-white text-lg font-semibold">
            ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô / ‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô
        </div>
        <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡∏´‡∏∏‡πâ‡∏ô -->
        <div class="w-full md:w-9/12 bg-gray-50 p-4 rounded-md shadow space-y-4">
            <div class="grid grid-cols-2 gap-2">
                <p>ü™™ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô: {{issuadata.cusId}}</p>
                <p>üóì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏• : {{formatDate(issuadata.dateIssue)}}</p>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <p>üôç‚Äç‚ôÇÔ∏è ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• : {{issuadata.fullname}} [{{issuadata.custype}}]</p>
            </div>
            <hr class="my-2 border-gray-300" />
            <div class="grid grid-cols-2 gap-2">
                <p>üîñ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô : {{issuadata.stkNote}}</p>
                <p>üÜî ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏∏‡πâ‡∏ô : {{issuadata.stkNostart}} - {{issuadata.stkNoend }}</p>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <p>üî¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô : {{issuadata.unit}}</p>
                <p>üí∞ ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏´‡∏∏‡πâ‡∏ô : {{issuadata.unitValue | number:'1.0-0'}}</p>
            </div>
            <div class="grid grid-cols-2 gap-2" *ngIf="issuadata.acctype != '001'">
                <p>üè¶ ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡πÇ‡∏î‡∏¢ : {{issuadata.paydesc}}</p>
            </div>
            <div *ngIf="issuadata.acctype == '001'">
                <div class="flex gap-2">
                    <p>üè¶ ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡πÇ‡∏î‡∏¢ : {{issuadata.paydesc}}{{issuadata.acctypedesc}} ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ :
                        {{issuadata.accno}} ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ : {{issuadata.accname}}</p>
                </div>
            </div>
            <hr class="my-2 border-gray-300" />
            <div class="grid grid-row-2 gap-2">
                <p>üìÑ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô : {{issuadata.statusDesc}}</p>
                <p>üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ : {{issuadata.note || "-"}}</p>
            </div>
            <hr class="my-2 border-gray-300" />
            <!-- ‡∏õ‡∏∏‡πà‡∏° -->
            <div class="flex justify-center gap-4 pt-4">
                <button (click)="approveSelectedIssue()"
                    class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-md transition">
                    ‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                </button>
                <button (click)="notApproveSelectedIssue()"
                    class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md transition">
                    ‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ‚úÖ Loading Overlay ‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ + ‡∏°‡∏≠‡∏á‡∏ó‡∏∞‡∏•‡∏∏ + ‡πÄ‡∏ö‡∏•‡∏≠ -->
<div *ngIf="loading"
    class="fixed inset-0 z-50 flex items-center justify-center bg-gray-100 bg-opacity-40 backdrop-blur-sm"
    style="background-color: rgba(128, 128, 128, 0.7);">
    <div class="text-center">
        <svg class="animate-spin h-10 w-10 text-blue-600 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none"
            viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" />
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" />
        </svg>
        <p class="text-lg text-white font-medium">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
    </div>
</div>