<!-- dashboard.component.html -->
<div class="min-h-screen bg-gray-50">
  <!-- Sidebar -->
  <aside
    [class]="'fixed left-0 top-0 h-full bg-white shadow-lg border-r border-gray-200 z-40 transition-all duration-300 ' + (sidebarCollapsed ? 'w-16' : 'w-64')">

    <!-- Toggle Button -->
    <button (click)="toggleSidebar()"
      class="absolute -right-3 top-6 bg-white border border-gray-200 rounded-full w-6 h-6 flex items-center justify-center hover:bg-gray-50 transition-colors shadow-md z-50">
      <span
        [class]="'text-gray-600 text-xs transition-transform duration-300 ' + (sidebarCollapsed ? 'rotate-180' : '')">
        ‚óÄ
      </span>
    </button>

    <!-- Logo & Title -->
    <div class="p-6 border-b border-gray-200">
      <div class="flex items-center space-x-3">
        <div
          class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-white text-xl">üíº</span>
        </div>
        <div
          [class]="'transition-all duration-300 overflow-hidden ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
          <h1 class="text-lg font-bold text-gray-800 whitespace-nowrap">‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°</h1>
          <p class="text-sm text-gray-500 whitespace-nowrap">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</p>
        </div>
      </div>
    </div>

    <!-- Navigation Menu -->
    <nav class="p-4 space-y-2">

      <!-- ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° -->
      <div class="relative">
        <div (click)="openMenu('home')"
          [class]="'w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ' + (sidebarCollapsed ? 'px-2 justify-center' : '')"
          [attr.title]="sidebarCollapsed ? '‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°' : null">
          <div class="flex items-center space-x-3">
            <span class="text-xl flex-shrink-0">üìë</span>
            <span
              [class]="'font-medium transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
              ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°
            </span>
          </div>
          <span *ngIf="!sidebarCollapsed" class="text-sm text-gray-400" [class.rotate-180]="isHomeOpen">‚ñº</span>
        </div>
        <div *ngIf="isHomeOpen && !sidebarCollapsed" class="ml-10 mt-1 space-y-1">
          <a *ngFor="let sub of generalMenu" [routerLink]="sub.route" routerLinkActive="text-blue-600"
            class="block text-sm text-gray-600 hover:text-blue-700 transition-colors">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full top-0 ml-2 bg-gray-800 text-white text-xs p-2 rounded shadow z-50 whitespace-nowrap">
          <a *ngFor="let sub of generalMenu" [routerLink]="sub.route" routerLinkActive="text-blue-400"
            class="block text-sm hover:underline text-white py-1">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
      </div>

      <!-- ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô -->
      <div class="relative">
        <div (click)="openMenu('sales')"
          [class]="'w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ' + (sidebarCollapsed ? 'px-2 justify-center' : '')"
          [attr.title]="sidebarCollapsed ? '‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô' : null">
          <div class="flex items-center space-x-3">
            <span class="text-xl flex-shrink-0">üìä</span>
            <span
              [class]="'font-medium transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
              ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡∏´‡∏∏‡πâ‡∏ô
            </span>
          </div>
          <span *ngIf="!sidebarCollapsed" class="text-sm text-gray-400" [class.rotate-180]="isSalesOpen">‚ñº</span>
        </div>
        <div *ngIf="isSalesOpen && !sidebarCollapsed" class="ml-10 mt-1 space-y-1">
          <a *ngFor="let sub of saleMenu" [routerLink]="sub.route" routerLinkActive="text-blue-600"
            class="block text-sm text-gray-600 hover:text-blue-700 transition-colors">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full top-0 ml-2 bg-gray-800 text-white text-xs p-2 rounded shadow z-50 whitespace-nowrap">
          <a *ngFor="let sub of saleMenu" [routerLink]="sub.route" routerLinkActive="text-blue-400"
            class="block text-sm hover:underline text-white py-1">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
      </div>

      <!-- ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô -->
      <div class="relative">
        <div (click)="openMenu('financial')"
          [class]="'w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ' + (sidebarCollapsed ? 'px-2 justify-center' : '')"
          [attr.title]="sidebarCollapsed ? '‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô' : null">
          <div class="flex items-center space-x-3">
            <span class="text-xl flex-shrink-0">üí∞</span>
            <span
              [class]="'font-medium transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
              ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô
            </span>
          </div>
          <span *ngIf="!sidebarCollapsed" class="text-sm text-gray-400" [class.rotate-180]="isFinancialOpen">‚ñº</span>
        </div>
        <div *ngIf="isFinancialOpen && !sidebarCollapsed" class="ml-10 mt-1 space-y-1">
          <a *ngFor="let sub of financialMenu" [routerLink]="sub.route" routerLinkActive="text-blue-600"
            class="block text-sm text-gray-600 hover:text-blue-700 transition-colors">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full top-0 ml-2 bg-gray-800 text-white text-xs p-2 rounded shadow z-50 whitespace-nowrap">
          <a *ngFor="let sub of financialMenu" [routerLink]="sub.route" routerLinkActive="text-blue-400"
            class="block text-sm hover:underline text-white py-1">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
      </div>

      <!-- ‡πÑ‡∏ü‡∏•‡πå -->
      <div class="relative">
        <div (click)="openMenu('file')"
          [class]="'w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ' + (sidebarCollapsed ? 'px-2 justify-center' : '')"
          [attr.title]="sidebarCollapsed ? '‡πÑ‡∏ü‡∏•‡πå' : null">
          <div class="flex items-center space-x-3">
            <span class="text-xl flex-shrink-0">‚ö°</span>
            <span
              [class]="'font-medium transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
              ‡πÑ‡∏ü‡∏•‡πå
            </span>
          </div>
          <span *ngIf="!sidebarCollapsed" class="text-sm text-gray-400" [class.rotate-180]="isFileOpen">‚ñº</span>
        </div>
        <div *ngIf="isFileOpen && !sidebarCollapsed" class="ml-10 mt-1 space-y-1">
          <a *ngFor="let sub of fileMenu" [routerLink]="sub.route" routerLinkActive="text-blue-600"
            class="block text-sm text-gray-600 hover:text-blue-700 transition-colors">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full top-0 ml-2 bg-gray-800 text-white text-xs p-2 rounded shadow z-50 whitespace-nowrap">
          <a *ngFor="let sub of fileMenu" [routerLink]="sub.route" routerLinkActive="text-blue-400"
            class="block text-sm hover:underline text-white py-1">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
      </div>

      <!-- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô -->
      <div class="relative">
        <div (click)="openMenu('report')"
          [class]="'w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ' + (sidebarCollapsed ? 'px-2 justify-center' : '')"
          [attr.title]="sidebarCollapsed ? '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô' : null">
          <div class="flex items-center space-x-3">
            <span class="text-xl flex-shrink-0">üìä</span>
            <span
              [class]="'font-medium transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
              ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
            </span>
          </div>
          <span *ngIf="!sidebarCollapsed" class="text-sm text-gray-400" [class.rotate-180]="isReportOpen">‚ñº</span>
        </div>
        <div *ngIf="isReportOpen && !sidebarCollapsed" class="ml-10 mt-1 space-y-1">
          <a *ngFor="let sub of reportMenu" [routerLink]="sub.route" routerLinkActive="text-blue-600"
            class="block text-sm text-gray-600 hover:text-blue-700 transition-colors">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full top-0 ml-2 bg-gray-800 text-white text-xs p-2 rounded shadow z-50 whitespace-nowrap">
          <a *ngFor="let sub of reportMenu" [routerLink]="sub.route" routerLinkActive="text-blue-400"
            class="block text-sm hover:underline text-white py-1">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
      </div>

      <!-- ‡∏£‡∏∞‡∏ö‡∏ö -->
      <div class="relative">
        <div (click)="openMenu('system')"
          [class]="'w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer ' + (sidebarCollapsed ? 'px-2 justify-center' : '')"
          [attr.title]="sidebarCollapsed ? '‡∏£‡∏∞‡∏ö‡∏ö' : null">
          <div class="flex items-center space-x-3">
            <span class="text-xl flex-shrink-0">üõ†Ô∏è</span>
            <span
              [class]="'font-medium transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">
              ‡∏£‡∏∞‡∏ö‡∏ö
            </span>
          </div>
          <span *ngIf="!sidebarCollapsed" class="text-sm text-gray-400" [class.rotate-180]="isSystemOpen">‚ñº</span>
        </div>
        <div *ngIf="isSystemOpen && !sidebarCollapsed" class="ml-10 mt-1 space-y-1">
          <ng-container *ngFor="let sub of systemMenu">
            <!-- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ children -->
            <a *ngIf="!sub.children" [routerLink]="sub.route" routerLinkActive="text-blue-600"
              class="block text-sm text-gray-500 hover:text-blue-700 transition-colors mb-3">
              {{ sub.icon }} {{ sub.label }}
            </a>

            <!-- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ children -->
            <div *ngIf="sub.children" class="space-y-1">
              <div class="text-sm text-gray-500 font-semibold mt-2">{{ sub.icon }} {{ sub.label }}</div>
              <a *ngFor="let child of sub.children" [routerLink]="child.route" routerLinkActive="text-blue-600"
                class="block text-sm text-gray-600 hover:text-blue-700 ml-4 transition-colors">
                - {{ child.label }}
              </a>
            </div>
          </ng-container>
        </div>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full top-0 ml-2 bg-gray-800 text-white text-xs p-2 rounded shadow z-50 whitespace-nowrap">
          <a *ngFor="let sub of systemMenu" [routerLink]="sub.route" routerLinkActive="text-blue-400"
            class="block text-sm hover:underline text-white py-1">
            {{ sub.icon }} {{ sub.label }}
          </a>
        </div>
      </div>

    </nav>

    <!-- Logout Button -->
    <div
      [class]="'absolute bottom-6 transition-all duration-300 ' + (sidebarCollapsed ? 'left-2 right-2' : 'left-4 right-4')">
      <button (click)="logout()"
        [class]="'w-full flex items-center space-x-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors group relative ' + (sidebarCollapsed ? 'justify-center' : 'justify-center')"
        [attr.title]="sidebarCollapsed ? '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö' : null">
        <span class="flex-shrink-0">üö™</span>
        <span
          [class]="'transition-all duration-300 overflow-hidden whitespace-nowrap ' + (sidebarCollapsed ? 'w-0 opacity-0' : 'w-auto opacity-100')">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
        <div *ngIf="sidebarCollapsed"
          class="absolute left-full ml-2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50">
          ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
        </div>
      </button>
    </div>
  </aside>

  <!-- Main Content Area -->
  <div [class]="'transition-all duration-300 ' + (sidebarCollapsed ? 'ml-16' : 'ml-64')">
    <!-- Top Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 px-6 py-4 flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <button class="lg:hidden p-2 rounded-lg hover:bg-gray-100">
          <span class="text-xl">‚ò∞</span>
        </button>
        <div>
          <h2 class="text-xl font-semibold text-gray-800">Dashboard</h2>
          <p class="text-sm text-gray-500">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</p>
        </div>
      </div>

      <div class="flex items-center space-x-4">
        <!-- Notifications -->
        <button class="relative p-2 rounded-lg hover:bg-gray-100">
          <span class="text-xl">üîî</span>
          <span
            class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">3</span>
        </button>

        <!-- User Profile -->
        <div class="flex items-center space-x-3">
          <div
            class="w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-800 rounded-full flex items-center justify-center">
            <span class="text-white text-sm font-semibold">{{ getUserInitials(currentUser.fullname) }}</span>
          </div>
          <div class="flex flex-col">
            <span class="text-sm font-medium text-gray-700">{{ currentUser.fullname || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠' }}</span>
            <span class="text-xs text-gray-500">{{ getUserLevelName(currentUser.level) }}</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="p-6">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>

<!-- Mobile Menu Overlay (for responsive) -->
<div class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30 hidden" id="mobile-menu-overlay">
  <div class="fixed left-0 top-0 h-full w-64 bg-white shadow-lg transform -translate-x-full transition-transform"
    id="mobile-menu">
    <!-- Mobile menu content same as sidebar -->
  </div>
</div>